<!DOCTYPE html>
<html>
  <head>
    <title>Ecommerce</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>

    </style>
  </head>

  <body>
  <%= render "shared/menu" %>
    <%= yield %>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js" integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  function add_to_cart(id) {
    $(document).ready(function(){

      $.ajaxSetup({
  headers: {
    'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
  }
});
      $.ajax({
        url:'/cart_items',
        method: 'POST',
        data: {id:id},
        success:function(result){
          alert("OK");
        }
      });
    });

  }

  function increament(id){
    $(document).ready(function() {
      var quantity = $('#quantity'+id).val();
      $('#quantity'+id).val(quantity);
         if(quantity>0){
          $.ajaxSetup({
      headers: {
        'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
      }
    });
      $.ajax({
        url:'/increament',
        method: 'GET',
        data: {id:id},
        success:function(result){
        quantity=+quantity+1;
      $('#quantity'+id).val(quantity);
        }
      });
      }
    });
  }

  function decreament(id){
    $(document).ready(function() {
      var quantity = $('#quantity'+id).val();
      if(quantity>0){
          $.ajaxSetup({
      headers: {
        'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
      }
    });
      $.ajax({
        url:'/decreament',
        method: 'GET',
        data: {id:id},
        success:function(result){

      quantity=quantity-1;
      $('#quantity'+id).val(quantity);
        }
      });
      }
    });
  }

  function remove_product(id){
    $(document).ready(function() {
      if (confirm('Do you want to remove this item?')){
      $.ajaxSetup({
      headers: {
        'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
      }
      });
      $.ajax({
        url:'/remove_item',
        method: 'GET',
        data: {id:id},
        success:function(result){
      if (result == 'Deleted'){
      $('#product'+id).remove();
      }
        }
      });
      }
    });
  }




</script>

  </body>
</html>
